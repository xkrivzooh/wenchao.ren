<!DOCTYPE html>
<html lang="zh-cn" >
<head>
	<meta name="generator" content="Hugo 0.76.5" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="" />
	
	
	
	<title>被遗忘的博客  </title>
	
    
    
    <meta name="description" content="被遗忘的博客" />
    

    
    
    <meta name="keywords" content="JAVA, Spring, IOT, KAFKA, python, mysql" />
    

	
	<link rel="alternate" type="application/rss+xml" href="https://wenchao.ren/index.xml" title="被遗忘的博客" />
    

    <style type="text/css">
    </style>

    <link rel="shortcut icon" href="https://wenchao.ren/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://wenchao.ren/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://wenchao.ren/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://wenchao.ren/css/idea.css" />
    <script src="https://wenchao.ren/js/highlight.min.js"></script>
    <script src="https://wenchao.ren/js/highlightjs-line-numbers.min.js"></script>
    <script>hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
    </script>


    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://wenchao.ren">
                    <span>被遗忘的博客</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title"></p>
            <div class="my_socials">
                
                
                <a href="https://github.com/xkrivzooh" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                
                <a href="https://weibo.com/AnotherRobot/home" title="weibo" target="_blank"><i class="ri-weibo-fill"></i></a>
                
                
                <a href="https://wenchao.ren/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/org-elasticsearch-client-transport-nonodeavailableexception-none-of-the-configured-nodes-are-available/'>org.elasticsearch.client.transport.NoNodeAvailableException: None of the configured nodes are available</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>问题描述 今天在操作es的过程中出现了异常:
org.elasticsearch.client.transport.NoNodeAvailableException: None of the configured nodes are available  而我创建es client的代码也很简单，核心是：
Settings settings = Settings.builder() .put(&quot;cluster.name&quot;, esClusterInfo.getClusterName()) .put(&quot;client.transport.sniff&quot;, true) //自动嗅探整个集群的状态，把集群中其他ES节点的ip添加到本地的客户端列表中 .build();  我的排查步骤 记录一下我当时的排查过程：
 看异常第一反应是集群有问题，但是排查集群的节点以后，发现集群的节点都是没问题的。 而后开始检查settings中设置的cluster.name的是否正确发现也是正确的 google发现很多人是因为将es集群的端口写错，也就是9300错写为9200，但是检查我的数据以后发现也是没问题的。 而后开始怀疑我设置的client.transport.sniff的缘故，因为这个参数的作用是：   使客户端去嗅探整个集群的状态，把集群中其它机器的ip地址加到客户端中。这样做的好处是，一般你不用手动设置集群里所有集群的ip到连接客户端，它会自动帮你添加，并且自动发现新加入集群的机器
 但是这个参数有一个问题就是：
 当ES服务器监听（publish_address ）使用内网服务器IP，而访问（bound_addresses ）使用外网IP时，不要设置client.transport.sniff为true。不设置client.transport.sniff时，默认为false(关闭客户端去嗅探整个集群的状态)。因为在自动发现时会使用内网IP进行通信，导致无法连接到ES服务器。因此此时需要直接使用addTransportAddress方法把集群中其它机器的ip地址加到客户端中。
 但是检查我的环境，发现我的环境全部是内网，所以设置不设置这个client.transport.sniff是没区别的。
最后持续google许久，也没发现问题，喝杯茶刷了一会手机突然想起印象中es client的版本和es集群的版本不一致也有可能 出问题，于是google了一波es 版本不一致这个关键字，果然是因为版本不一致导致的。
ES client和ES集群版本不一致的问题 我遇到的这个问题是es集群的版本比我使用的es client的版本低，相当于我使用高版本的client去访问低版本的集群，所以出现org.elasticsearch.client.transport.NoNodeAvailableException: None of the configured nodes are available问题。
因此我们平时需要注意es的版本问题。......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2019.01.14</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/es/">es</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/%E4%BD%BF%E7%94%A8let-s-encrypt%E9%85%8D%E7%BD%AEnginx%E8%AF%81%E4%B9%A6/'>使用Let&#39;s Encrypt配置nginx证书</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>Automatically enable HTTPS on your website with EFF&rsquo;s Certbot, deploying Let&rsquo;s Encrypt certificates
主要参考：https://certbot.eff.org/lets-encrypt/centosrhel7-nginx
操作起来很简单，主要用到了下面的命令：
sudo yum install nginx sudo certbot --nginx sudo certbot renew --dry-run 0 0 1 * * certbot renew --post-hook &quot;/usr/sbin/nginx -s reload&quot;  ......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.27</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/nginx/">nginx</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/mac%E5%A4%96%E6%8E%A54k%E6%98%BE%E7%A4%BA%E5%99%A8%E9%80%891080p%E5%AD%97%E4%BD%93%E5%8F%91%E8%99%9A/'>Mac外接4k显示器选1080p字体发虚</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>MacBook外接4K显示器使用HDMI数据线选择缩放模式，然后选择1080p，会出现外接显示器字体发虚的问题，一般有下面几种的排查方式：
 检查数据线，尽量使用DP接口 hdmi数据线的话，尽量使用原厂的，亲测淘宝便宜的数据线会出现显示器内有小颗粒闪烁的问题，我之前还以为是显示器的问题。 mac系统没有开启hidpi模式，此时安装神器https://pan.baidu.com/share/link?shareid=31306&amp;uk=1679854806&amp;errno=0&amp;errmsg=Auth%20Login%20Sucess&amp;&amp;bduss=&amp;ssnerror=0&amp;traceid=, 打开然后，选择1080P(HIDPI)就好了。  ......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.19</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/%E6%9D%82%E8%AE%B0/">杂记</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/slow-startup-tomcat-because-of-securerandom/'>Slow startup Tomcat because of SecureRandom</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>今天在新机器上启动tomcat应用的时候，发现巨慢，检查日志发现有如下信息：
Jan 09, 2018 8:44:35 PM org.apache.catalina.util.SessionIdGenerator createSecureRandom INFO: Creation of SecureRandom instance for session ID generation using [SHA1PRNG] took [239,939] milliseconds.  这块初始化SecureRandom用了239,939毫秒，之前没遇到这个问题。查了一下发现在官方wiki https://wiki.apache.org/tomcat/HowTo/FasterStartUp#Entropy_Source
 Entropy Source Tomcat 7+ heavily relies on SecureRandom class to provide random values for its session ids and in other places. Depending on your JRE it can cause delays during startup if entropy source that is used to initialize SecureRandom is short of entropy. You will see warning in the logs when this happens, e.......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.04</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/java/">java</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/spring-resttemplate-parse-gzip-response/'>Spring RestTemplate parse gzip response</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>假设http://10.89.xx.xx:8080/_/metrics接口返回的数据格式是gzip格式 他的Response Headers信息如下
HTTP/1.1 200 OK Server: Apache-Coyote/1.1 Content-Encoding: gzip Content-Type: text/plain;charset=UTF-8 Transfer-Encoding: chunked Date: Thu, 28 Dec 2017 08:13:53 GMT  如果我们使用Spring RestTemplate想直接拿到String形式的返回，而不是byte[]格式，那么可以使用如下的方式：
import org.springframework.http.HttpStatus; import org.springframework.http.ResponseEntity; import org.springframework.http.client.HttpComponentsClientHttpRequestFactory; import org.springframework.web.client.RestTemplate; import org.apache.http.impl.client.HttpClientBuilder; public static void main(String[] args) { HttpComponentsClientHttpRequestFactory clientHttpRequestFactory = new HttpComponentsClientHttpRequestFactory( HttpClientBuilder.create().build()); RestTemplate restTemplate = new RestTemplate(clientHttpRequestFactory); ResponseEntity&lt;String&gt; responseEntity = restTemplate.getForEntity(&quot;http://10.89.xx.xxx:8080/_/metrics&quot;, String.class); HttpStatus statusCode = responseEntity.getStatusCode(); System.out.println(responseEntity.getBody()); }  ......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.04</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/java/">java</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/java-rsa%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/'>Java RSA非对称加密</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>最近的一个项目中，agent和master双方需要远程通信，但是需要双方认证以及传输的信息加密，因此就选择了RSA这个非对称加密算法实现了netty的handler。
##实现思路 简要的描述一下实现思路：
 首先生成一对公钥和私钥 所有的master都使用这个私钥进行加密、解密 所有的agent都使用这个公钥进行加密和解密 master发给agent的信息，使用私钥加密，master收到agent的信息，使用私钥解密 agent发给master的信息，使用公钥加密，agent收到master的信息，使用公钥解密 无论是agent还是master，对收到的信息，只要解密失败，那么就丢弃  这样相当于实现了agent和master的认证，以及消息的加密传输。挺有意思的。 ##生成公钥私钥
###使用java代码生成：
private static final String RSA = &quot;RSA&quot;; public static KeyPair buildKeyPair() throws NoSuchAlgorithmException { final int keySize = 2048; KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(RSA); keyPairGenerator.initialize(keySize); return keyPairGenerator.genKeyPair(); } KeyPair keyPair = buildKeyPair(); PublicKey pubKey = keyPair.getPublic(); PrivateKey privateKey = keyPair.getPrivate();  ###shell生成 我在这个项目实现中，是别生成了公钥文件和私钥文件，作为了工程的配置文件来用的，因此使用了shell的命令：
ssh-keygen -t rsa -b 2048 -C &quot;any string&quot; openssl pkcs8 -topk8 -inform PEM -outform DER -in id_rsa -out private_key.......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.04</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/java/">java</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>

<div class="post animated fadeInDown">
    <div class="post_title">
        <h2><a href='/posts/%E8%87%AA%E5%B7%B1%E5%AE%9E%E7%8E%B0lru-cache/'>自己实现LRU Cache</a></h2>
    </div>
    
    <div class="list">
        <div class="post_content markdown">
            <p>今天闲的无事，写一个LRU的缓存练练手，不过提前说好哈，最好的办法是直接使用Guava中的方法：
import com.google.common.cache.CacheBuilder; import java.util.concurrent.ConcurrentMap; public class GuavaLRUCache { public static void main(String[] args) { ConcurrentMap&lt;String, String&gt; cache = CacheBuilder.newBuilder() .maximumSize(2L) .&lt;String, String&gt;build().asMap(); cache.put(&quot;a&quot;, &quot;b&quot;); cache.put(&quot;b&quot;, &quot;c&quot;); System.out.println(cache); cache.put(&quot;a&quot;, &quot;d&quot;); System.out.println(cache); cache.put(&quot;c&quot;, &quot;d&quot;); System.out.println(cache); } }  如果自己实现的话，就比较挫了：
public class LRUCache&lt;K, V&gt; { private final int limit; private final Map&lt;K, V&gt; cache; private final Deque&lt;K&gt; deque; private final ReentrantLock reentrantLock = new ReentrantLock(); private static final int DEFAULT_CAPACITY = 16; private static final float DEFAULT_LOAD_FACTOR = 0.......</p>
        </div>
    </div>
    
    <div class="post_footer">
        <div class="meta">
            <div class="info">
                <span class="field">
                    <i class="ri-map-pin-time-line"></i>
                    <span class="date">2018.12.04</span>
                </span>
                
                <span class="field tags">
                    <i class="ri-stack-line"></i>
                    
                    <a href="https://wenchao.ren/tags/java/">java</a>
                    
                </span>
                
            </div>
        </div>
    </div>
</div>


<div class="pagination">
    
    
    <a href="/page/11/" class="pre">
        Prev
    </a>
    
    
    
</div>
        </div>
    </div>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://varkai.com">Designed by VarKai,</a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
    </div>

    <div class="footer_slogan">
        <span></span>
    </div>
</footer>
    <script src="https://wenchao.ren/js/jquery-3.5.1.min.js"></script>
<link href="https://wenchao.ren/css/fancybox.min.css" rel="stylesheet">
<script src="https://wenchao.ren/js/fancybox.min.js"></script>
<script src="https://wenchao.ren/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



</body>

</html>